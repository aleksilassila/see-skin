// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id                String  @id @default(cuid())
  name              String
  description       String  @default("")
  imageUrl          String?
  shopPageUrl       String?
  ingredientsString String

  ingredients Ingredient[]

  addedIrritantToUsers User[]
}

model Ingredient {
  id                String            @id @default(cuid())
  name              String
  cosingRef         Int               @unique
  description       String            @default("")
  function          String
  aliases           IngredientAlias[]
  ingredientClasses IngredientClass[] @default([])

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  products Product[]

  addedIrritantToUsers User[] @relation("_AddedIrritantToUser")
  irritantToUsers      User[] @relation("_IrritantToUser")
}

model IngredientAlias {
  id   String @id @default(cuid())
  name String

  ingredientId String
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
}

model User {
  id          String    @id @default(cuid())
  googleId    String?   @unique
  email       String
  password    String?
  name        String
  accessLevel Int       @default(0)
  logoutAt    DateTime?

  didSetupProfile Boolean  @default(false)
  skinType        SkinType @default(NORMAL)

  addedIrritativeIngredients Ingredient[] @relation("_AddedIrritantToUser")
  addedIrritativeProducts    Product[]
  irritants                  Ingredient[] @relation("_IrritantToUser")
  irritativeClasses          IngredientClass[] @default([])
}

enum SkinType {
  NORMAL
  DRY
  OILY
  COMBINATION
  NORMAL_SENSITIVE
  DRY_SENSITIVE
  OILY_SENSITIVE
  COMBINATION_SENSITIVE
}

enum IngredientClass {
  SAFE
  PARABEN
  ALCOHOL
  SULFATE
  FUNGAL_ACNE_TRIGGER
  DRY_IRRITANT
  OILY_IRRITANT
  DRY_OILY_IRRITANT
  SENSITIVE_IRRITANT
}
